name: Daily API Sync

on:
    schedule:
        - cron: '55 17 * * *' # Runs at 17:55 UTC daily (11:55 PM BD time)
        - cron: '10 10 * * *' # Runs at 10:10 UTC daily (4:10 AM BD time)

jobs:
    hit-api:
        runs-on: ubuntu-latest
        if: github.ref == 'refs/heads/main'
        steps:
            - name: Get current date
              id: date
              run: echo "today=$(date +'%Y-%m-%d')" >> $GITHUB_OUTPUT

            - name: Call API
              run: |
                  curl --request POST \
                    --url https://github-tracker-fahad.vercel.app/api/sync \
                    --header 'content-type: application/json' \
                    --data "{\"startDate\": \"${{ steps.date.outputs.today }}\", \"endDate\": \"${{ steps.date.outputs.today }}\"}"
